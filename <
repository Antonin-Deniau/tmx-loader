var tmx = require('tmx-parser');
var _   = require('lodash');
var loaderUtils = require('loader-utils');

module.exports = function(text) {
  var query = loaderUtils.parseQuery(this.query);
  var grid = [];

  tmx.parse(text, "../areas/tilemap.tmx", function(err, map) {
    if (err) { throw err }

    var width = map.width;
    var height = map.height;

    _.each(map.layers, function(layer) {
      if (layer.name == "map") {
        console.log(layer);
      } else {
      }
    });
    return 'module.exports = ' //+ JSON.stringify(map);
  });
}
